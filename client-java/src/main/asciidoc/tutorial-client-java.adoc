== The Java client application
:icons: font
:rootdir: ../../../..
:srcdir: {rootdir}/client-java/src

The client application is a simple command-line Java application which will continuously publish and consume autogenerated messages
on a remote messaging topic. It's a single main class which consists in 3 parts:

. Bootstrap the GraniteDS container
. Define the callback for message reception
. Execute the remote call

Here is the source code for the first bootstrap/configuration part:

[[client.destination]]
[source,java,indent=0]
.main/java/org/graniteds/tutorial/chat/client/ChatClient.java
----
include::{srcdir}/main/java/org/graniteds/tutorial/chat/client/ChatClient.java[tags=client-setup]
----
<1> Bootstrap the GraniteDS Tide context.
<2> Configure a +ServerSession+ object in the context with the server url and context path.
<3> Start the server session, initializing all required resources.
<4> Create a producer and a consumer for the topic named +chatTopic+ (see the server definiton <<server.destination,here>>)
 and both configured with a subtopic named +room+.

Once configured, we can next setup and subscribe the message consumer:

[source,java,indent=0]
.main/java/org/graniteds/tutorial/chat/client/ChatClient.java
----
include::{srcdir}/main/java/org/graniteds/tutorial/chat/client/ChatClient.java[tags=client-consume]
----
<1> We add a message listener on the +Consumer+ object which simply writes the incoming messages on the system output.
<2> We subscribe the consumer to the server topic. Note that +Consumer.subscribe()+ is asynchronous so we are using +get()+
to synchronously wait for the result.

Next the client generates random messages and publishes them using the +Producer+ component:

[source,java,indent=0]
.main/java/org/graniteds/tutorial/chat/client/ChatClient.java
----
include::{srcdir}/main/java/org/graniteds/tutorial/chat/client/ChatClient.java[tags=client-publish]
----

Finally, here are the maven dependencies for the Java module:
[source,xml,indent=0]
----
include::https://raw.githubusercontent.com/graniteds-tutorials/graniteds-tutorial/master/client-java-base/pom.xml[tags=maven-deps]
include::https://raw.githubusercontent.com/graniteds-tutorials/graniteds-tutorial/master/client-java-base/client-java/pom.xml[tags=maven-deps]
----